<HTML>
<HEAD>
<BASE TARGET="_top">
<TITLE>United States Patent: 7750793</TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">
<a name="top"></a>
<center>
<IMG SRC="/netaicon/PTO/patfthdr.gif" alt="[US Patent & Trademark Office, Patent Full Text and Image Database]">
<br>
<table>
<tr><td align=center>
<a href="http://www.uspto.gov/patft/index.html"><img src="/netaicon/PTO/home.gif" alt="[Home]" border="0" valign=middle></a>
<a href="/netahtml/PTO/search-bool.html"><img src="/netaicon/PTO/boolean.gif" alt="[Boolean Search]" border="0" valign=middle></a>
<A HREF="/netahtml/PTO/search-adv.htm"><IMG BORDER="0" SRC="/netaicon/PTO/manual.gif" ALT="[Manual Search]" valign=middle></A>
<a href="/netahtml/PTO/srchnum.htm"><img src="/netaicon/PTO/number.gif" alt="[Number Search]" border="0" valign=middle></a>
<A HREF="http://www.uspto.gov/patft/help/help.htm"><IMG BORDER="0" valign=middle SRC="/netaicon/PTO/help.gif" ALT="[Help]"></A>
</td></tr>
<tr><td align=center>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=17&p=1&f=S&l=50&d=PTXT&S1=((RFID+OR+%22radio+frequency+identification%22).ABTX.+AND+(((Cryptography+OR+Crypto)+OR+Encryption)+OR+Cipher))&Query=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(Cryptography+or+Crypto+or+Encryption+or+Cipher)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/hitlist.gif border=0 ALT=[HIT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=17&p=2&f=S&l=50&d=PTXT&S1=((RFID+OR+%22radio+frequency+identification%22).ABTX.+AND+(((Cryptography+OR+Crypto)+OR+Encryption)+OR+Cipher))&Query=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(Cryptography+or+Crypto+or+Encryption+or+Cipher)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextlist.gif border=0 ALT=[NEXT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=16&p=1&f=G&l=50&d=PTXT&S1=((RFID+OR+%22radio+frequency+identification%22).ABTX.+AND+(((Cryptography+OR+Crypto)+OR+Encryption)+OR+Cipher))&OS=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(Cryptography+or+Crypto+or+Encryption+or+Cipher)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/prevdoc.gif border=0 ALT=[PREV_DOC]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=18&p=1&f=G&l=50&d=PTXT&S1=((RFID+OR+%22radio+frequency+identification%22).ABTX.+AND+(((Cryptography+OR+Crypto)+OR+Encryption)+OR+Cipher))&OS=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(Cryptography+or+Crypto+or+Encryption+or+Cipher)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextdoc.gif border=0 ALT=[NEXT_DOC]></A>

<a href="#bottom"><img src="/netaicon/PTO/bottom.gif" alt="[Bottom]" valign=middle border=0></A>
</td></tr>
<tr><td align=center>
<A HREF="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/ShowShoppingCart?backUrl1=http%3A//patft1.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D17%26p%3D1%26f%3DG%26l%3D50%26d%3DPTXT%26S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).ABTX.%252BAND%252B(((Cryptography%252BOR%252BCrypto)%252BOR%252BEncryption)%252BOR%252BCipher))%26OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(Cryptography%252Bor%252BCrypto%252Bor%252BEncryption%252Bor%252BCipher)&backLabel1=Back%20to%20Document%3A%207750793"><img border=0 src="/netaicon/PTO/cart.gif" border=0 valign=middle alt="
[View Shopping Cart]"></A>
<A HREF="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/AddToShoppingCart?docNumber=7750793&backUrl1=http%3A//patft1.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D17%26p%3D1%26f%3DG%26l%3D50%26d%3DPTXT%26S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).ABTX.%252BAND%252B(((Cryptography%252BOR%252BCrypto)%252BOR%252BEncryption)%252BOR%252BCipher))%26OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(Cryptography%252Bor%252BCrypto%252Bor%252BEncryption%252Bor%252BCipher)&backLabel1=Back%20to%20Document%3A%207750793">
<img border=0 src="/netaicon/PTO/order.gif" valign=middle alt="[Add to Shopping Cart]"></A>
</td></tr>
<tr><td align=center>
<a href=http://patimg2.uspto.gov/.piw?Docid=07750793&homeurl=http%3A%2F%2Fpatft.uspto.gov%2Fnetacgi%2Fnph-Parser%3FSect1%3DPTO2%2526Sect2%3DHITOFF%2526u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%2526r%3D17%2526p%3D1%2526f%3DG%2526l%3D50%2526d%3DPTXT%2526S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).ABTX.%252BAND%252B(((Cryptography%252BOR%252BCrypto)%252BOR%252BEncryption)%252BOR%252BCipher))%2526OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(Cryptography%252Bor%252BCrypto%252Bor%252BEncryption%252Bor%252BCipher)%2526RS%3D(ABST%2F(RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522)%252BAND%252B(((Cryptography%252BOR%252BCrypto)%252BOR%252BEncryption)%252BOR%252BCipher))&PageNum=&Rtype=&SectionNum=&idkey=NONE&Input=View+first+page><img src="/netaicon/PTO/image.gif" alt="[Image]" border="0" valign="middle"></A>

</td></tr>
</table>
</center>
<TABLE WIDTH="100%">
<TR><TD ALIGN="LEFT" width="50%">&nbsp;</TD>
<TD ALIGN=RIGHT VALIGN=BOTTOM WIDTH=50%><FONT SIZE=-1>( <STRONG>17</STRONG></FONT> <FONT SIZE=-2>of</FONT> <STRONG><FONT SIZE=-1>275</STRONG> )</FONT></TD></TR></TABLE>
<HR>
<TABLE WIDTH="100%">
<TR>	<TD ALIGN="LEFT" WIDTH="50%"><B>United States Patent </B></TD>
	<TD ALIGN="RIGHT" WIDTH="50%"><B>7,750,793</B></TD>
</TR>
<TR><TD ALIGN="LEFT" WIDTH="50%"><b>
 Juels
 </B>
</TD>
<TD ALIGN="RIGHT" WIDTH="50%"> <B>
July 6, 2010
</B></TD>
</TR>
</TABLE>
<HR>
<font size="+1">Methods and apparatus for RFID device authentication
</font><BR>
<BR><CENTER><B>Abstract</B></CENTER>
<P>Methods and apparatus are disclosed for use in an <B><I>RFID</I></B> system comprising a
     plurality of <B><I>RFID</I></B> devices and at least one reader which communicates with
     one or more of the devices. In one aspect of the invention, an identifier
     transmitted by a given one of the <B><I>RFID</I></B> devices is received by a reader or
     by an associated verifier via the reader. At least first and second codes
     are determined, by the reader or verifier, with the first code being a
     valid code for the identifier, and the second code being an invalid code
     for the identifier. The reader, or verifier via the reader, communicates
     with the given device to determine if the device is able to confirm that
     the first code is a valid code and the second code is an invalid code.
</P>
<HR>
<TABLE WIDTH="100%"> <TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%">Inventors: </TD><TD ALIGN="LEFT" WIDTH="90%">
 <B>Juels; Ari</B> (Brookline, MA) </TD></TR><TR> <TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%">Assignee:</TD>
<TD ALIGN="LEFT" WIDTH="90%">

<B>EMC Corporation</B>
 (Hopkinton, 
MA)
<BR>

</TD>
</TR><TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%" NOWRAP>Appl. No.:
</TD><TD ALIGN="LEFT" WIDTH="90%">                    
<B>11/191,633</B></TD></TR>
  <TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%">Filed:
  </TD><TD ALIGN="LEFT" WIDTH="90%">                    
  <B>July 28, 2005</B></TD></TR>
</TABLE>
<HR> <CENTER><B>Related U.S. Patent Documents</B></CENTER> <HR> <TABLE WIDTH="100%"> <TR><TD WIDTH="7%"></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD></TR> <TR><TD align="left">
</TD><TD align=center><B><U>Application Number</U></B></TD><TD align=center><B><U>Filing Date</U></B></TD><TD align=center><B><U>Patent Number</U></B></TD><TD align=center><B><U>Issue Date</U></B></TD><TD</TD></TR><TR><TD align=center> </TD><TD align=center>60591982</TD><TD align=center>Jul., 2004</TD><TD align=center></TD><TD align=center></TD><TD</TD></TR><TR><TD align=center> </TD><TD align=center>60660771</TD><TD align=center>Mar., 2005</TD><TD align=center></TD><TD align=center></TD><TD</TD></TR><TR><TD align=center> 
</TD>
</TR> </TABLE><HR>
<p>
<TABLE WIDTH="100%">
  <TR><TD VALIGN=TOP ALIGN="LEFT" WIDTH="40%"><B>Current U.S. Class:</B></TD>
  <TD VALIGN=TOP ALIGN="RIGHT" WIDTH="80%"><B>340/10.5</B>  ; 340/10.1; 340/10.51; 340/5.61; 340/572.1; 340/572.3</TD></TR>
  <TR><TD VALIGN=TOP ALIGN="LEFT" WIDTH="40%"><B>Current International Class: </B></TD>
  <TD VALIGN=TOP ALIGN="RIGHT" WIDTH="80%">H04Q 5/22&nbsp(20060101); G08B 13/14&nbsp(20060101)</TD></TR>
  <TR><TD VALIGN=TOP ALIGN="LEFT" WIDTH="40%"><B>Field of Search: </B></TD>
  <TD ALIGN="RIGHT" VALIGN="TOP" WIDTH="80%">
  







 340/10.5,5.61,572.1,572.3,10.1,10.51 713/168 235/380
  </TD></TR>
</TABLE>
<HR><CENTER><B>References Cited  <a href="/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2Fsearch-adv.htm&r=0&f=S&l=50&d=PALL&Query=ref/7750793">[Referenced By]</A></B></CENTER><HR>
<CENTER><b>U.S. Patent Documents</b></CENTER>
<TABLE WIDTH="100%"> <TR><TD WIDTH="33%"></TD><TD WIDTH="33%"></TD><TD WIDTH="34%"></TD></TR> <TR> <TD ALIGN="left">
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F5467081">5467081</a></TD><TD align =left>
November 1995</TD><TD align=left>
Drews et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6061344">6061344</a></TD><TD align =left>
May 2000</TD><TD align=left>
Wood, Jr.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6630885">6630885</a></TD><TD align =left>
October 2003</TD><TD align=left>
Hardman et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6724895">6724895</a></TD><TD align =left>
April 2004</TD><TD align=left>
Turner et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6933848">6933848</a></TD><TD align =left>
August 2005</TD><TD align=left>
Stewart et al.</TD></TR><TR><TD align=left>
<a href="http://appft1.uspto.gov/netacgi/nph-Parser?TERM1=20030137403&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0137403</a></TD><TD align =left>
July 2003</TD><TD align=left>
Carrender et al.</TD></TR><TR><TD align=left>
<a href="http://appft1.uspto.gov/netacgi/nph-Parser?TERM1=20040066278&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0066278</a></TD><TD align =left>
April 2004</TD><TD align=left>
Hughes et al.</TD></TR><TR><TD align=left>
<a href="http://appft1.uspto.gov/netacgi/nph-Parser?TERM1=20040100359&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0100359</a></TD><TD align =left>
May 2004</TD><TD align=left>
Reade et al.</TD></TR><TR><TD align=left>
<a href="http://appft1.uspto.gov/netacgi/nph-Parser?TERM1=20040100363&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0100363</a></TD><TD align =left>
May 2004</TD><TD align=left>
Lane et al.</TD></TR><TR><TD align=left>
<a href="http://appft1.uspto.gov/netacgi/nph-Parser?TERM1=20040160324&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0160324</a></TD><TD align =left>
August 2004</TD><TD align=left>
Stilp</TD></TR><TR><TD align=left>
<a href="http://appft1.uspto.gov/netacgi/nph-Parser?TERM1=20040222878&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0222878</a></TD><TD align =left>
November 2004</TD><TD align=left>
Juels</TD></TR><TR><TD align=left>
<a href="http://appft1.uspto.gov/netacgi/nph-Parser?TERM1=20040223481&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0223481</a></TD><TD align =left>
November 2004</TD><TD align=left>
Juels et al.</TD></TR><TR><TD align=left>
<a href="http://appft1.uspto.gov/netacgi/nph-Parser?TERM1=20040233040&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0233040</a></TD><TD align =left>
November 2004</TD><TD align=left>
Lane et al.</TD></TR><TR><TD align=left>
<a href="http://appft1.uspto.gov/netacgi/nph-Parser?TERM1=20050017844&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2005/0017844</a></TD><TD align =left>
January 2005</TD><TD align=left>
Cole</TD></TR><TR><TD align=left>
<a href="http://appft1.uspto.gov/netacgi/nph-Parser?TERM1=20050099268&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2005/0099268</a></TD><TD align =left>
May 2005</TD><TD align=left>
Juels et al.</TD></TR><TR><TD align=left>
<a href="http://appft1.uspto.gov/netacgi/nph-Parser?TERM1=20050114326&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2005/0114326</a></TD><TD align =left>
May 2005</TD><TD align=left>
Smith et al.</TD></TR><TR><TD align=left>

</TD>
</TR> </TABLE><CENTER><b>Foreign Patent Documents</b></CENTER>
<TABLE WIDTH="100%"> <TR><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD></TR> <TR> <TD ALIGN="left">
</TD><TD align=left>WO03050757</TD><TD></TD><TD align=left>
Jun., 2003</TD><TD></TD><TD align=left>
WO</TD></TR><TR><TD align=left>
</TD><TD align=left>PCT/US05/28839</TD><TD></TD><TD align=left>
Dec., 2006</TD><TD></TD><TD align=left>
WO</TD></TR><TR><TD align=left>

</TD>
</TR> </TABLE> <TABLE WIDTH="90%"> <BR> <CENTER><B>Other References</B></CENTER> <TR><TD><ALIGN=LEFT><BR>SE. Sarma et al., "Radio-Frequency Identification: Security Risks and Challenges," RSA Laboratories, CryptoBytes, vol. 6, No. 1, pp. 1-32,
Spring 2003. cited by other
.<BR>S.A. Weis et al., "Security and Privacy Aspects of Low-Cost Radio Frequency Identification Systems," Proceedings of the First International Conference on Security in Pervasive Computing, 12 pages, 2003. cited by other
.<BR>A. Juels, "Yoking-Proofs' for RFID Tags," PerCom Workshops, IEEE Computer Society, pp. 138-143, 2004. cited by other
.<BR>"EPC.TM. Radio-Frequency Identity Protocols Class-1 Generation 2 UHF RFID Protocol for Communications at 860 MHz--960 MHz," Version 1.0.8., pp. 1-93, 2005. cited by other
.<BR>J. Stern et al., "Cryptanalysis of the OTM Signature Scheme from FC'02," Financial <A Name=h4 HREF=#h3></A><A  HREF=#h5></A><B><I>Cryptography</I></B> '03, pp. 138-148, Springer-Verlag, LNCS No. 2742, 2003. cited by other
.<BR>A. Juels, "Minimalist <A Name=h5 HREF=#h4></A><A  HREF=#h6></A><B><I>Cryptography</I></B> for Low-Cost RFID Tags," Security in Communication Networks, (SCN 04), pp. 149-164, Springer-Verlag, LNCS No. 3352, 2004. cited by other
.<BR>"23 mm Glass Transponder," Radio Frequency Identification Systems, Texas Instruments, 1 page, Dec. 2001. cited by other
.<BR>"12 mm Wedge Transponder," Radio Frequency Identification Systems, Texas Instruments, 1 page, Dec. 2001. cited by other
.<BR>M. Jakobsson et al., "Security Weaknesses in Bluetooth," 16 pages, 2001. cited by other
.<BR>"Read/Write Transponder," Atmel, 22 pages, Apr. 2003. cited by other
.<BR>S.A. Weis, "Security and Privacy in Radio-Frequency Identification Devices," Master of Science Thesis, MIT, pp. 1-79, May 2003. cited by other
.<BR>A. Juels et al., "Squealing Euros: Privacy Protection in RFID-Enabled Banknotes," Financial <A Name=h6 HREF=#h5></A><A  HREF=#h7></A><B><I>Cryptography,</I></B> Springer-Verlag, 18 pages, 2003. cited by other
.<BR>P. Golle et al., "Universal Re<A Name=h7 HREF=#h6></A><A  HREF=#h8></A><B><I>-encryption</I></B> of Mixnets," Springer-Verlag , 14 pages, 2002. cited by other
.<BR>D.L. Brock, "The Electronic Product Code (EPC): A Naming Scheme for Physical Objects," White Paper, MIT-AUTOID-WH-002, MIT Auto-ID Center, http://www.autoidcenter.org., pp. 1-21, Jan. 2001. cited by other
.<BR>Auto-ID Center, Technical Report, "13.56 MHz ISM Band Class 1 Radio Frequency Identification Tag Interface Specification: Recommended Standard, Version 1.0.0," MIT-AUTOID-TR-011, MIT Auto-ID Center, http://autoidcenter.org, pp. 1-31, Feb. 2003.
cited by other
.<BR>S. Garfinkel, "An RFID Bill of Rights," Technology Review, p. 35, Oct. 2002. cited by other
.<BR>S.E. Sarma et al., "RFID Systems, Security & Privacy Implications," White Paper, MIT-AUTOID-WH-014, MIT Auto-ID Center, pp. 1-16, Nov. 2002. cited by other
.<BR>D.W. Engels, "HF Identity Tag Action Group: Scope and Deliverables," Technical Report, MIT-AUTOID-TR-020, MIT Auto-ID Center, pp. 1-5, Jul. 2003. cited by other
.<BR>S.E. Sarma, "Towards the 5 Tag," White Paper, Technical Report MIT-AUTOID-WH-006, MIT Auto ID Center, pp. 1-19, Nov. 2001. cited by other
.<BR>R. Agrawal et al., "Privacy-Preserving Data Mining," Proc. of the ACM SIGMOD Conference on Management of Data, ACM Press, 12 pages, 2000. cited by other
.<BR>D. Chaum, "Untraceable Electronic Mail, Return Addresses, and Digital Pseudonyms," Communications of the ACM, vol. 24, No. 2, 9 pages, Feb. 1981. cited by other
.<BR>M. Mealling, "Auto-ID Object Name Service (ONS) 1.0," Auto-ID Working Draft, 17 pages, Aug. 2003. cited by other
.<BR>M.G. Reed et al., "Protocols Using Anonymous Connections: Mobile Applications," In Security Protocols, Proceedings of the 5th International Workshop, Springer-Verlag LNCS 1361, 11 pages, 1997. cited by other
.<BR>S. Clark et al., "Auto-ID Savant Specification 1.0," Auto-ID Center, pp. 1-59, Sep. 2003. cited by other
.<BR>Auto-ID Center, Technical Report, "860 MHz-960MHz Class 1 Radio Frequency Identification Tag Radio Frequency & Logical Communication Interface Specification: Recommended Standard, Version 1.0.0," MIT-AUTOID-TR-007, MIT Auto-ID Center, pp. 1-17, Nov.
2002. cited by other
.<BR>J. Collins, "Marks & Spencer Expands RFID Trial," RFID Journal, www.rfidjournal.com, 2 pages, Feb. 10, 2004. cited by other
.<BR>Security Technology, "Where's the Smart Money?," The Economist, www.economist.com, 3 pages, Feb. 7, 2002. cited by other
.<BR>RFID: eWEEK.com Special Report, www.eweek.com, 14 pages, 2004. cited by other
.<BR>K.P. Fishkin et al., "Some Methods for Privacy in RFID Communication,"lst European Workshop on Security in Ad-Hoc and Sensor Networks, ESAS, pp. 1-13, 2004. cited by other
.<BR>United States Food and Drug Administration, "Combating Counterfeit Drugs: A Report of the Food and Drug Administration," pp. 1-45, Feb. 18, 2004. cited by other
.<BR>L.C. Guillou et al., "A Practical Zero-Knowledge Protocol Fitted to Security Microprocessor Minimizing Both Transmission and Memory," Eurocrypt, Springer-Verlag, pp. 123-128, 1998. cited by other
.<BR>J. Hoffstein et al., "NTRU: A Ring-Based Public Key Cryptosystem," ANTS III, Springer-Verlag, 22 pages, 1998. cited by other
.<BR>A. Juels et al.,"The Blocker Tag: Selective Blocking of RFID Tags for Consumer Privacy," 8th ACM Conference on Computer and Communications Security, ACM Press, 16 pages, 2003. cited by other
.<BR>J. Mara, "Euro Scheme Makes Money Talk," Wired News, www.wired.com, 4 pages, Jul. 9, 2003. cited by other
.<BR>D. McCullagh, "RFID Tags: Big Brother in Small Packages," CNET, www.news.com, 3 pages, Jan. 13, 2003. cited by other
.<BR>G. Romen, "Nokia Unveils RFID Phone Reader," RFID Journal, 2 pages, Mar. 17, 2004. cited by other
.<BR>"RFID, Privacy, and Corporate Data," RFID Journal, www.rfidjournal.com, 5 pages, Jun. 2, 2003. cited by other
.<BR>R.L. Rivest, "Chaffing and Winnowing: Confidentiality Without <A Name=h8 HREF=#h7></A><A  HREF=#h9></A><B><I>Encryption,</I></B>" CryptoBytes, 8 pages, 1998. cited by other
.<BR>M.I Shamos, "Paper v. Electronic Voting Records--An Assessment," http://euro.ecom.cmu.edu, 20 pages, Apr. 2004. cited by other
.<BR>Texas Instruments, RFID eNews, Issue No. 10, 4 pages, Jul. 2002. cited by other
.<BR>C.P. Wallace, "The Color of Money," Time Europe, 3 pages, Sep. 2001. cited by other
.<BR>"Wal-Mart, DOD Forcing RFID," Wired News, www.wired.com, 3 pages, Nov. 3, 2003. cited by other. </TD></TR></TABLE> <BR>  <I>Primary Examiner:</I> Holloway, III; Edwin C
<BR>
  <I>Attorney, Agent or Firm:</I> <coma>Ryan, Mason & Lewis, LLP
<BR>
<HR>
<CENTER><B><I>Parent Case Text</B></I></CENTER>
<HR>
<BR><BR>RELATED APPLICATION(S)
<BR><BR>The present application claims the priority of U.S. Provisional Patent
     Application Ser. No. 60/660,771, filed Mar. 11, 2005 and entitled
     "Strengthening EPC Tags Against Cloning," and U.S. Provisional Patent
     Application Ser. No. 60/591,982, filed Jul. 29, 2004 and entitled
     "Strengthening EPC Tags Against Cloning," the disclosures of which are
     incorporated by reference herein.
<BR><BR>The present application is also related to U.S. patent application Ser.
     No. 10/782,309, filed Feb. 19, 2004 and entitled "Low-Complexity
     Cryptographic Techniques For Use With Radio Frequency Identification
     Devices," which issued as U.S. Pat. No. 7,532,104 on May 12, 2009; U.S.
     patent application Ser. No. 10/673,540, filed Sep. 29, 2003 and entitled
     "Method And Apparatus For Selective Blocking Of Radio Frequency
     Identification Devices," which issued as U.S. Pat. No. 6,970,070 on Nov.
     29, 2005; and U.S. patent application Ser. No. 10/915,189, filed Aug. 10,
     2004 and entitled "Radio Frequency Identification System With Privacy
     Policy Implementation Based On Device Classification," which issued as
     U.S. Pat. No. 7,298,243 on Nov. 20, 2007; which are commonly assigned
     herewith and incorporated by reference herein.
<HR>
<CENTER><B><I>Claims</B></I></CENTER> <HR> <BR><BR>What is claimed is:<BR><BR> 1.  A method for use in an RFID system comprising a plurality of RFID devices and at least one reader which communicates with one or more of the devices, the method comprising
the steps of: receiving an identifier transmitted by a given one of the RFID devices;  determining at least first and second codes, wherein the first code is a valid code for the identifier, and the second code is an invalid code for the identifier; 
communicating with the given device to determine if the device is able to confirm that the first code is a valid code and the second code is an invalid code;  and designating the given device as an authenticated device only if the given device is able to
confirm that the first code is a valid code and the given device is able to confirm that the second code is an invalid code;  wherein the communicating step further comprises: sending the first code to the given device and receiving from the given device
in response to the first code a corresponding first validity indicator;  sending the second code to the given device and receiving from the given device in response to the second code a corresponding second validity indicator;  and processing the first
validity indicator received from the given device to determine if the given device is able to confirm that the first code is a valid code;  and processing the second validity indicator received from the given device to determine if the given device is
able to confirm that the second code is an invalid code.
<BR><BR> 2.  The method of claim 1 wherein the identifier comprises an electronic product code (EPC).
<BR><BR> 3.  The method of claim 2 wherein the given RFD device comprises an EPC tag.
<BR><BR> 4.  The method of claim 1 wherein the first code comprises a valid kill code of the given RFID device.
<BR><BR> 5.  The method of claim 1 wherein the determining step further comprises generating a set of q codes comprising q-1 invalid codes and a single valid code with the valid code being inserted in a particular position in the set.
<BR><BR> 6.  The method of claim 5 wherein q=2.
<BR><BR> 7.  The method of claim 5 wherein the communicating step further comprises transmitting a particular one of the codes to the given RFID device, and processing a response to determine whether or not the given RFID device considers the particular
code to be valid.
<BR><BR> 8.  The method of claim 7 wherein the transmitting and processing steps are repeated for each of the codes in the set of q codes.
<BR><BR> 9.  The method of claim 5 wherein the set of q codes comprises a set {P.sub.i.sup.(n)}.sub.n=1.sup.q selected uniformly at random without duplication from {0, 1}.sup.k with the valid code comprising a code K.sub.i which replaces a random element
P.sub.i.sup.(j) for j.epsilon..sub.U {1, 2, .  . . , q}.
<BR><BR> 10.  The method of claim 5 wherein the set of q codes is generated pseudorandomly, utilizing a one-way hash function and a master key.
<BR><BR> 11.  The method of claim 1 wherein the receiving, determining and communicating steps are each implemented at least in part in the reader.
<BR><BR> 12.  The method of claim 1 wherein the receiving, determining and communicating steps are each implemented at least in part in a verifier which is separate from the reader and which communicates with the RFID device via the reader.
<BR><BR> 13.  The method of claim 12 wherein, of the reader and the verifier, only the verifier is aware of which of the codes is the valid code for the identifier.
<BR><BR> 14.  The method of claim 5 wherein the q codes are supplied to the reader by a verifier which is separate from the reader, and the reader is unaware as to which of the q codes is the valid code.
<BR><BR> 15.  The method of claim 1 wherein the codes are supplied to the reader by a verifier only upon fulfillment by the reader of at least one specified condition.
<BR><BR> 16.  The method of claim 15 wherein the codes are supplied by the verifier to the reader only if the reader can demonstrate to the verifier that the reader is in communication with the given RFID device.
<BR><BR> 17.  A method for use in an RFID system comprising a plurality of RFID devices and at least one reader which communicates with one or more of the devices, the method comprising the steps of: receiving an identifier transmitted by a given one of
the RFID devices;  determining a code corresponding to the identifier, the code being utilizable to initiate a control function of the given RFID device;  transmitting the code to the given RFID device;  and designating the given RFID device as an
authenticated device only if an expected response to transmission of the code is received from the given RFID device;  wherein the code comprises a predetermined control code that directs the given RFID device to enter an inactive mode of operation;  and
wherein at least one of the given RFID device and the reader are configured to ensure that the given RFID device fails to enter the inactive mode of operation responsive to receiving the control code;  and wherein the expected response comprises an error
code generated by the RFID device to indicate that the given RFID device failed to enter the inactive mode of operation responsive to receiving the control code.
<BR><BR> 18.  The method of claim 17 wherein the code comprises a valid kill code of the given RFID device, and wherein at least one of the given RFID device and the reader are configured such that the RFID device registers insufficient power for the
kill code.
<BR><BR> 19.  A method for use in an RFID system comprising a plurality of RFID devices and at least one reader which communicates with one or more of the devices, the method comprising the steps of: receiving an identifier transmitted by a given one of
the RFID devices;  transmitting a first code to the given RFID device;  receiving a second code from the given RFID device responsive to transmission of the first code to the given RFID device;  and determining if the second code is a valid code for the
given RFID device;  wherein each of the first and second codes comprises a code which is stored in the given RFID device and utilized to initiate a corresponding control function of the given RFID device by directing the given RFID device to enter a
corresponding mode of operation;  and wherein release of the second code by the given RFID device is conditioned upon confirmation of the validity of the first code by the given RFID device.
<BR><BR> 20.  The method of claim 19 wherein the given RFID device comprises an EPC tag.
<BR><BR> 21.  The method of claim 19 wherein the first code comprises a valid access code of the given RFID device.
<BR><BR> 22.  The method of claim 19 wherein the second code comprises a valid kill code of the given RFID device.
<BR><BR> 23.  The method of claim 20 wherein the second code comprises a particular one of a plurality of portions of a valid kill code of the given RFID device.
<BR><BR> 24.  An apparatus for use in an RFID system comprising a plurality of RFID devices and at least one reader which communicates with one or more of the devices, the apparatus comprising: a processing device comprising a processor coupled to a
memory, the processing device being configured to receive an identifier transmitted by a given one of the RFID devices, to determine at least first and second codes, wherein the first code is a valid code for the identifier, and the second code is an
invalid code for the identifier, to communicate with the given device to determine if the device is able to confirm that the first code is a valid code and the second code is an invalid code, and to designate the given device as an authenticated device
only if the given device is able to confirm that the first code is a valid code and the given device is able to confirm that the second code is an invalid code;  wherein the processing device is further configured to send the first code to the given
device and to receive from the given device in response to the first code a corresponding first validity indicator, to send the second code to the given device and to receive from the given device in response to the second code a corresponding second
validity indicator, to process the first validity indicator received from the given device to determine if the given device is able to confirm that the first code is a valid code, and to process the second validity indicator received from the given
device to determine if the given device is able to confirm that the second code is an invalid code.
<BR><BR> 25.  The apparatus of claim 24 wherein the processing device is implemented in the reader.
<BR><BR> 26.  The apparatus of claim 24 wherein the processing device is implemented in a verifier which is separate from the reader but which communicates with the RFID devices via the reader.
<BR><BR> 27.  An apparatus for use in an RFID system comprising a plurality of RFID devices and at least one reader which communicates with one or more of the devices, the apparatus comprising: a processing device comprising a processor coupled to a
memory, the processing device being configured to receive an identifier transmitted by a given one of the RFID devices, to transmit a first code to the given RFID device, to receive a second code from the given RFID device responsive to transmission of
the first code to the given RFID device, and to determine if the second code is a valid code for the given RFID device;  wherein release of the second code by the given RFID device is conditioned upon confirmation of the validity of the first code by the
given RFID device;  and wherein each of the first and second codes comprises a code which is stored in the given RFID device and utilized to initiate a corresponding control function of the given RFID device by directing the given RFID device to enter a
corresponding mode of operation.
<BR><BR> 28.  An RFID device for use in an RFID system comprising a plurality of RFID devices and at least one reader which communicates with one or more of the devices, the RFID device being configured to transmit an identifier to the reader, to receive
from the reader at least first and second codes, wherein the first code is a valid code for the identifier, and the second code is an invalid code for the identifier, and to transmit information to the reader indicating confirmation that the first code
is a valid code and the second code is an invalid code;  wherein the RFID device receives the first code from the reader and in response to receipt of the first code sends the reader a corresponding first validity indicator;  and wherein the RFID device
receives the second code from the reader and in response to receipt of the second code sends the reader a corresponding second validity indicator;  the first and second validity indicators sent from the RFID device to the reader providing sufficient
information to permit designation of the RFID device as an authenticated device based on a determination as to whether the RFID device is able to confirm which of the first and second codes is the valid code, said determination comprising a first
determination that the first code is a valid code for the identifier and a second determination that the second code is an invalid code for the identifier.<HR> <CENTER><B><I> Description</B></I></CENTER> <HR> <BR><BR>FIELD OF THE INVENTION
<BR><BR>The present invention relates generally to radio frequency identification (RFID) tags or other types of RFID devices, and more particularly to techniques for authentication of such devices so as to prevent tag counterfeiting or other types of
cloning attacks.
<BR><BR>BACKGROUND OF THE INVENTION
<BR><BR>A conventional RFID tag typically comprises an integrated circuit transceiver capable of transmitting a unique serial number or other identifying information to a nearby reader in response to a query from the reader.  Many RFID tags are "passive"
in that they do not include a battery or other power source, but instead obtain the power necessary to operate from the query signal itself.
<BR><BR>Ongoing RFID tag development efforts have led to significant cost and size reductions, which should result in a rapid proliferation of RFID tags into many new areas of use.  For example, RFID tags are expected to replace printed barcodes in
consumer product applications.  The Electronic Product Code (EPC) tag is a form of RFID device that is emerging as a successor to the printed barcode.  EPC tags are an evolving standard under development by an organization called EPCglobal, a joint
venture between the UCC and EAN, the organizations that oversee barcode standards in the U.S.  and Europe, respectively.  An EPC is the form of identifier that an individual EPC tag emits as prescribed by the EPCglobal standard.  An EPC includes not just
the information contained in a conventional printed barcode, namely the manufacturer and type of a particular product, but also a unique serial number.  Additional details can be found in the current version of the EPCglobal standard document, "EPC.TM. 
Radio-Frequency Identity Protocols Class-1 Generation-2 UHF RFID Protocol for Communications at 860 MHz-960 MHz," Version 1.0.8, 2005.
<BR><BR>The unique serial number of an EPC tag associated with an object can serve as a pointer to a database entry containing a detailed history of the object.  Thanks to the features of automated scanning and unique identification, RFID systems promise
fine-grained tracking of inventory on an unprecedented scale.
<BR><BR>Some commercial segments, like the pharmaceutical industry, are coming to view EPC tags as an anti-counterfeiting tool.  EPC tags are a potent mechanism for object identification, and can facilitate the compilation of detailed object histories
and pedigrees.  They are poor authenticators, though, as they possess no explicit authentication functionality.  The EPCglobal standards prescribe no mechanism for EPC readers to authenticate the validity of the tags they scan.  An EPC tag emits its EPC
promiscuously, i.e., to any querying reader.  Readers accept the validity of the EPCs they scan at face value.  Thus, EPC tags are vulnerable to counterfeiting or other types of cloning attacks.
<BR><BR>An attacker can learn an EPC tag's essential data, its EPC, simply by scanning it or by gaining access to an appropriate tag database.  The term "skimming" is used herein to denote the process of scanning an EPC tag to obtain its EPC for the
purpose of cloning the tag.  Furthermore, if the unique identifiers in a manufacturer's EPCs are not random, e.g., if they are sequential, then an attacker that sees an EPC on one item can guess or fabricate another valid EPC.  In brief, "identity theft"
of EPC tags is a straightforward matter because EPCs are data objects that are easily separable from EPC tags.
<BR><BR>Some commercially available RFID tags can perform cryptographic challenge-response protocols.  Such tags offer resistance to cloning attacks involving skimming.  They typically cost significantly more than EPC tags, though, and may therefore be
practical only for certain niche applications.
<BR><BR>Privacy-protecting authentication protocols for RFID tags are described in S. E. Sarma et al., "Radio-frequency-identification security risks and challenges," RSA Laboratories, CryptoBytes, 6(1), 2003, and S. A. Weis et al., "Security and privacy
aspects of low-cost radio frequency identification systems," First International Conference on Security in Pervasive Computing, 2003.  However, these protocols utilize cryptographic hash functions, and thus may be unsuitable for Class-1 EPC tags.
<BR><BR>The above-cited U.S.  patent application Ser.  No. 10/782,309 discloses an authentication approach referred to as "minimalist" <B><I>cryptography,</I></B> including a security model for RFID environments that permits a form of dynamic challenge-response
protocol without the use of complex cryptographic operations.  However, even this minimalist approach may require greater tag resources than are available in the current generation of EPC tags.
<BR><BR>Another approach, known as "yoking," allows a pair of tags with minimal resources to construct a one-time proof that they have been read simultaneously.  See A. Juels, "`Yoking-proofs` for RFID tags," PerCom Workshops 2004, pp.  138-143, IEEE
Computer Society, 2004.  The techniques underlying yoking could be used to enable tags to authenticate themselves to readers, but aim to secure only one-time use, rather than repeated use.
<BR><BR>There is a considerable body of research on the design of lightweight public-key <B><I>encryption</I></B> and digital-signing algorithms, largely intended for use in smart cards and similarly small computational devices.  See, e.g., J. Stern et al.,
"Cryptanalysis of the OTM signature scheme from FC '02," R. Wright, editor, Financial <B><I>Cryptography</I></B> '03, pp.  138-148, Springer-Verlag, 2003, LNCS No. 2742.  However, even the most lightweight of these many schemes is likely to be well beyond the
capabilities of small RFID tags for quite some time to come.  A related area is security for sensor networks.  While lightweight, these devices are still more capable than RFID tags, as they typically include their own power sources.  Although recent
work has led to more compact implementations of symmetric-key primitives like AES for RFID tags, these are still well beyond the reach of Class-1 EPC tags today, and unsupported in the EPCglobal standard.
<BR><BR>Accordingly, a need exists for techniques for authenticating EPC tags and other types of RFID devices, so as to prevent counterfeiting or other cloning attacks without requiring cryptographic operations.
<BR><BR>SUMMARY OF THE INVENTION
<BR><BR>The present invention in accordance with one aspect thereof provides techniques for authenticating EPC tags or other RFID devices in an RFID system.  The RFID system generally includes a plurality of RFID devices and at least one reader which
communicates with one or more of the devices.
<BR><BR>In an aspect of the invention, an identifier transmitted by a given one of the RFID devices is received by a reader, or by a separate verifier via the reader.  At least first and second codes are determined by the reader or verifier, with the
first code being a valid code for the identifier, and the second code being an invalid code for the identifier.  These codes are communicated to the given RFID device by the reader, or by the verifier via the reader.  Return communications are processed
by the reader or verifier to determine if the RFID device is able to confirm that the first code is a valid code and the second code is an invalid code.  If the RFID device can so confirm, it has been authenticated.
<BR><BR>In an illustrative embodiment, the identifier comprises an EPC, and the given RFID device comprises an EPC tag, with the first code comprising a valid kill code of the EPC tag, and the second code comprising a spurious or invalid kill code of the
EPC tag.
<BR><BR>The first and second codes may be part of a set of q codes comprising q-1 invalid codes and a single valid code with the valid code being inserted in a particular position in the set.  For each of the codes in the set, the code is transmitted to
the given RFID device, and a corresponding response is processed to determine whether or not the given RFID device considers the particular code to be valid.  The set of q codes may comprise a set {P.sub.i.sup.(n)}.sub.n=1.sup.q selected uniformly at
random without duplication from {0, 1}.sup.k with the valid code comprising a code K.sub.i which replaces a random element P.sub.i.sup.(j) for j.epsilon..sub.U {1, 2, .  . . , q}.  As one possible alternative, the set of q codes may be generated
pseudorandomly, utilizing a one-way hash function and a master key.
<BR><BR>In embodiments in which the codes are generated and processed in a verifier which is separate from the reader, of the reader and the verifier only the verifier may be aware of which of the codes is the valid code for the identifier.  For example,
the q codes may be supplied to the reader by the separate verifier, with the reader being unaware as to which of the q codes is the valid code.  Such arrangements protect the system against compromised or otherwise untrusted readers.
<BR><BR>In another aspect of the invention, the codes may be supplied to the reader by the verifier only upon fulfillment by the reader of at least one specified condition.  For example, the codes may be supplied by the verifier to the reader only if the
reader can demonstrate to the verifier that the reader is in communication with the given RFID device.
<BR><BR>In yet another aspect of the invention, an identifier transmitted by a given one of the RFID devices is received by a reader, or by a separate verifier via the reader, and a code corresponding to the identifier is determined.  The code is
utilizable to initiate a control function of the given RFID device, and may be a valid kill code of the given RFID device.  The code is transmitted to the given RFID device, by the reader or by the verifier via the reader, and the given RFID device is
designated as an unauthenticated device if it fails to provide an expected response to transmission of the code.
<BR><BR>In a further aspect of the invention, an identifier transmitted by a given one of the RFID devices is received by a reader, or by a separate verifier via the reader.  A first code is transmitted to the given RFID device, by the reader or by the
verifier via the reader.  A second code is received from the RFID device responsive to transmission of the first code to the given RFID device, again by the reader or by the verifier via the reader.  A determination is made by the reader or verifier as
to whether the second code is a valid code for the given RFID device.  If it is, the RFID device has been authenticated.  In an illustrative embodiment of such an arrangement, in which the given RFID device comprises an EPC tag, the first code may
comprise a valid access code of the EPC tag, and the second code may comprise a valid kill code of the EPC tag.  As another example, the second code may comprise a particular one of a plurality of portions of a valid kill code of the EPC tag.
<BR><BR>Yet another aspect of the invention relates to an EPC tag or other RFID device for use in an RFID system comprising a plurality of RFID devices and at least one reader which communicates with one or more of the devices.  The RFID device is
configured to transmit an identifier to the reader, to receive from the reader at least first and second codes, wherein the first code is a valid code for the identifier, and the second code is an invalid code for the identifier, and to transmit
information to the reader indicating confirmation that the first code is a valid code and the second code is an invalid code.
<BR><BR>Advantageously, the present invention in the illustrative embodiments provides simple and efficient techniques for authenticating EPC tags or other RFID devices, in a manner that utilizes kill, access or other code functionality within the RFID
devices to prevent certain important cloning attacks without the need for cryptographic operations.
<BR><BR>These and other features and advantages of the present invention will become more readily apparent from the accompanying drawings and the following detailed description. <BR><BR>BRIEF DESCRIPTION OF THE DRAWINGS
<BR><BR>FIG. 1 is a simplified block diagram of an exemplary RFID system in which the present invention is implemented in one embodiment.
<BR><BR>FIG. 2 illustrates one possible implementation of an RFID device reader of the FIG. 1 system.
<BR><BR>FIGS. 3, 4, 5 and 6 show exemplary protocols for providing RFID device authentication in the FIG. 1 system in illustrative embodiments of the invention.
<BR><BR>DETAILED DESCRIPTION
<BR><BR>The present invention will be described herein with reference to an exemplary RFID system in which multiple RFID devices communicate with an RFID device reader.  It is to be appreciated, however, that the invention is not restricted to use in
this or any other particular RFID system configuration.
<BR><BR>The term "RFID device" as used herein is intended to include an RFID tag or any other type of device configurable for transmission of device-identifying information via radio frequency communications.  Although the following description will
refer primarily to EPC tags, it is to be understood that the techniques disclosed are applicable to other types of RFID tags, and more generally applicable to other types of RFID devices.  Also, the terms "radio frequency" or "RF" as used herein are not
intended to be restricted to any particular frequency range, but are instead intended to be construed more generally so as to encompass any contiguous or non-contiguous arrangement of one or more signal frequencies suitable for supporting wireless
communication between at least one device and at least one reader.
<BR><BR>As described in the above-cited U.S.  patent application Ser.  No. 10/915,189, a given RFID device in an illustrative embodiment of the invention may have one or more of a number of different classifications.  For example, the given RFID device
may be classified as one of public, private, blocker, unblocker, etc. The classification of the given RFID device may be dynamic, that is, it can vary over time.  Also, it is possible for a given RFID device to have multiple classifications at the same
time, depending upon the particular set of classifications in use.  The present invention, however, does not require the use of these or any other RFID device classification techniques.
<BR><BR>The device-identifying information associated with a given RFID device may be an EPC, a serial number or any other type of identifier.  It should be noted that not every identifier in a given set of unique identifiers need have a corresponding
realized device.
<BR><BR>The term "identifier" as used herein is intended to include a pseudonym of the type described in the above-cited U.S.  patent application Ser.  No. 10/782,309.  In addition, an identifier is intended to include any information suitable for
providing an indication of a classification of a particular RFID device.
<BR><BR>The term "reader" as used herein is intended to include any type of device capable of interacting with an RFID tag or other device so as to receive device-identifying information therefrom.
<BR><BR>1.  Example of an RFID System
<BR><BR>FIG. 1 shows an RFID system 100 in which the present invention is implemented.  The system 100 includes a number N of RFID tags 102, more particularly denoted by their associated tag identifiers T.sub.1, T.sub.2, .  . . T.sub.N, and an RFID
reader 104.  The reader 104 communicates with the tags 102 and receives identifying information therefrom, in the form of one or more transmitted identifiers.  The reader 104 is coupled via a network 106 to servers denoted 108, 110.
<BR><BR>A given RFID tag 102 in accordance with the invention generally includes circuitry comprising memory, processing logic and an RF transceiver.  These elements may be configured in a manner similar to that used in conventional RFID tags.
<BR><BR>One or more of the tags 102 may each comprise a so-called "blocker tag" configured with an ability to block the operation of a singulation algorithm utilized by the reader 104 in order to provide enhanced privacy for a user of the tag, as
described in the above-cited U.S.  patent application Ser.  No. 10/673,540.  The present invention, however, does not require the use of such blocker tags.
<BR><BR>One or more of the tags 102 may also or alternatively implement minimalist <B><I>cryptography,</I></B> soft blocking, or other techniques described in the above-cited U.S.  patent application Ser.  Nos.  10/782,309 and 10/915,189.  Again, the present invention
does not require the use of such techniques.
<BR><BR>The network 106 may represent a global computer network such as the Internet, a wide area network (WAN), a local area network (LAN), a satellite network, a telephone or cable network, or various portions or combinations of these and other types
of networks.  The servers 108, 110 may be conventional processor-based information processing devices of a type conventionally utilized in conjunction with RFID readers in an RFID system.
<BR><BR>The particular number N of tags 102 in the system 100 is purely arbitrary, and the system can be configured to support any desired number of tags.  Also, although only a single reader 104 is shown in the figure for simplicity and clarity of
illustration, the system will typically include multiple readers.  Furthermore, it should be noted that a given reader need not be connected to a network, and may instead operate as a stand-alone device, or may be only intermittently connected to the
network.  Also, a given reader can be directly connected to a server or other system element, rather than connected thereto over a network as illustrated in the example system 100.
<BR><BR>FIG. 2 shows one possible implementation of the reader 104 of the FIG. 1 system.  The reader in this implementation includes a processing block 200, comprising a processor 202 coupled to a memory 204, a network interface 206, an RF transceiver
210, and an antenna 212.  One or more of these elements may be implemented in whole or in part as a conventional microprocessor, digital signal processor, application-specific integrated circuit (ASIC) or other type of circuitry, as well as portions or
combinations of such circuitry elements.  Software programs for controlling the operation of the reader 104 may be stored in the memory 204 and executed by the processor 202.
<BR><BR>A typical RFID reader is generally only able to communicate with a single RFID tag at a time.  In effect, however, the reader may be viewed as broadcasting a query to all of the tags 102 at once.  If more than one tag responds to a query by the
reader, the reader detects a collision and executes a singulation algorithm which allows the reader to communicate with the conflicting tags one at a time.
<BR><BR>Conventional RFID tag systems may operate at a frequency of, for example, either 13.56 MHz or 915 MHz, and may utilize, for example, ALOHA-type singulation algorithms or tree-walking singulation algorithms.  Other frequencies, such as 125 kHz and
2.45 GHz, are also used, and employ similar singulation algorithms.  Such singulation algorithms are known in the art, and will therefore not be further described herein.  The invention can be utilized with a reader incorporating one of these known
singulation algorithms, or a reader incorporating another type of singulation algorithm, or any other type of reader, including a reader that does not singulate tags.  Thus, it is to be appreciated that the invention does not require the use of
singulation.
<BR><BR>The present invention in the illustrative embodiments provides techniques for RFID device authentication.  Advantageously, these techniques can be implemented without the use of cryptographic operations, and in a system which comprises EPCglobal
Class-1 Generation-2 UHF tags or other types of EPC tags.  Of course, the techniques described herein can be readily applied to other types of RFID devices.
<BR><BR>An RFID device authentication technique of the present invention may be implemented, by way of example, in a system in which RFID tags or RFID readers are implemented in mobile telephones, portable computers or other similar devices.  More
generally, such RFID device or RFID reader elements may be implemented in or otherwise comprise at least a portion of a mobile telephone, a portable computer, a personal digital assistant (PDA), a hardware-based authentication token such as an RSA
SecurID.RTM.  token commercially available from RSA Security Inc.  of Bedford, Mass., U.S.A., or any other type of processing device utilizable in implementing RFID device authentication functionality as described herein.  The invention thus does not
require any particular RFID device or reader configuration.
<BR><BR>In the illustrative embodiments, RFID device authentication is implemented in the FIG. 1 system using a number of exemplary protocols which will be described below in conjunction with the protocol diagrams of FIGS. 3 through 6.
<BR><BR>2.  EPC Tag Capabilities
<BR><BR>It will initially be assumed without limitation that the tags 102 of the FIG. 1 system comprise EPCglobal Class-1 Generation-2 UHF tags, which are likely to predominate in supply chains.  The illustrative embodiments leverage code-based
access-control and privacy enhancement mechanisms in EPC tags to achieve a type of challenge-response authentication.  These techniques can even strengthen EPC tags against cloning in environments with untrusted readers.  It is to be appreciated,
however, that the described techniques can be adapted in a straightforward manner to use with a wide variety of other types of RFID tags, or more generally, RFID devices.
<BR><BR>As noted above, as supply chains expand and automation becomes commonplace, users are likely to come to rely implicitly on RFID tags to authenticate goods.  Protecting EPC tags against cloning, however, is challenging, as they possess no explicit
authentication functionality.  EPC tags do possess features geared toward privacy protection and access control, provided using respective kill and access "personal identification numbers" or PINs, which are examples of what are more generally referred
to herein as "codes." In the illustrative embodiments, these features are leveraged to construct rudimentary tag-to-reader authentication protocols.  These protocols also facilitate the implementation of another inventive technique, referred to herein as
fulfillment-conditional PIN distribution (FCPD), which prevents en bloc theft of tag PINs by compromised readers.
<BR><BR>Throughout this description, we make a distinction between EPC tags and EPCs.  An EPC tag is a physical RFID device, while an EPC is the digital information belonging to and generally contained in a particular tag.  An EPC is a just a piece of
data, and thus separable from an EPC tag.
<BR><BR>While EPC tags carry no explicit mechanisms for authentication, as we have explained, they do possess some basic data-security features.  We briefly describe them here.  We distinguish between two types of tags.  A basic EPC tag is one that
carries only the mandatory features of the EPCglobal standard.  An enhanced EPC tag additionally includes an access-control function that is optional in the EPCglobal standard.
<BR><BR>The capabilities of basic and enhanced EPC tags will be addressed in separate subsections below.
<BR><BR>2.1 Basic EPC Tags
<BR><BR>Basic EPC tags have only one security feature that we exploit here, namely a privacy-enhancing kill command.  When an EPC tag receives this command, it "self-destructs," which is to say that it renders itself completely and permanently
inoperable.  To protect against accidental or malicious killing of tags, the kill command only takes effect when accompanied by a valid PIN.  In the EPCglobal standard, the kill PIN is 32 bits in length.
<BR><BR>Tag killing may be viewed as an access-control operation that succeeds only once.  The EPCglobal standard, though, has a feature that can serve in principle to permit multiple presentations of a valid kill PIN.  Recall that an EPC tag is passive,
meaning that it receives its power from a reader.  When it receives a kill command and valid PIN, but has insufficient power to disable itself, an EPC tag remains operational, and emits an error code.  When it receives a kill command with an invalid PIN,
the tag effectively ignores the command.
<BR><BR>In consequence, given the ability to cause an EPC tag to register insufficient power for the kill operation, one can cause a tag effectively to emit a "yes" or "no" indicating the validity of a kill PIN.  There are at least two ways that kill-PIN
verification might be consistently achievable.  The first involves modification of tags, the second, modification of readers:
<BR><BR>1.  Hobbling the kill command: The EPCglobal standard does not specify a criterion, e.g., a minimum power level, for a tag to accept a kill command.  Thus, a manufacturer could create an EPC-compliant tag that always registers insufficient power. In effect, such tags would possess the mandatory kill function in a degenerate form.  As the kill function aims at consumer privacy protection, and EPC tags will not reach the hands of consumers in many applications for quite some time, this modification
may prove acceptable in some sectors.
<BR><BR>2.  Power calibration: In principle, precise positioning of an EPC tag near a reader and precise calibration of the reader power level could cause a tag to register insufficient power for the kill command.  Successful implementation of such an
approach would require careful consideration of a variety of factors relating to design and configuration of the tags and other system elements.
<BR><BR>Other techniques can be used to make kill-PIN verification achievable.  For example, the tags may be redesigned to provide one or more additional conditions, based on power levels, codes or other factors, to provide a confirmation for a given tag
that it should indeed be killed before it actually allows itself to be killed.  Thus, tags can be designed to implement a two-level kill process, or other similar arrangement, which permits PIN verification of the type used in the illustrative
embodiments, while also preserving the privacy advantages of the kill function.  It is to be appreciated, however, that the invention may be implemented without any modification to existing tags.
<BR><BR>In section 3, we propose authentication techniques that assume the ability to validate kill PINs repeatedly in basic EPC tags.
<BR><BR>In section 5.1, we describe a situation in which the kill command is useful as a one-time authentication operation, i.e., without the need for non-standard implementation.  Our aim there is to use tag authentication as a subsidiary tool to
achieve the goal of preventing en bloc theft of tag PINs by compromised readers.
<BR><BR>2.2 Enhanced EPC Tags
<BR><BR>With regard to enhanced EPC tags, such tags respond to a command called access, whose implementation is optional in the EPCglobal standard.  When accompanied by a valid 32-bit access PIN, the access command causes a tag to transition into what is
called a "secured" state.  Tags may be configured such that certain commands only function when a tag is "secured." In particular, read access to the memory banks for the access and kill PINs may be made dependent on an EPC tag being "secured." The
standard supports no PINs other than the access and kill PINs.
<BR><BR>In consequence, although the EPC of a tag may be readily skimmed, a properly configured EPC tag does not promiscuously emit its PINs.  Thus the PINs are resistant to skimming.  We show how to exploit this feature to achieve a type of
challenge-response protocol.
<BR><BR>Another useful feature supported by the EPCglobal standard is the word-level granularity of read and write operations.  In particular, it is possible to read or write the upper or lower half of a PIN exclusively.
<BR><BR>3.  Authenticating Basic EPC Tags
<BR><BR>We now describe illustrative protocols to help defend basic EPC tags against skimming attacks.  Recall that we assume, as explained above, that the kill command may serve repeatedly to check the correctness of a kill PIN presented by a reader. 
We shall exploit this PIN-based reader-to-tag authentication feature in the kill operation, utilizing it to construct tag-to-reader authentication protocols.  For clarity of notation, let us denote by PIN-test (K) an EPC-tag command that causes a tag to
output a bit-response b. The value of b is a `0` if K is the correct kill PIN for the tag and `1` otherwise.
<BR><BR>In a system with N tags, such as system 100 of FIG. 1, let the integer i (with 1.ltoreq.i.ltoreq.N) denote the unique index of an EPC tag.  Let us denote the EPC identifier, i.e., the unique RFID readable string for tag i, by T.sub.i.  Let
K.sub.i denote the currently valid kill PIN for the tag having identifier T.sub.i.  We assume that K.sub.i is generated uniformly at random, and held as a shared secret between the tag and a trusted reader.
<BR><BR>We begin by presenting an elementary protocol SimpleTagAuth in FIG. 3.  In this and following figures, "A.fwdarw.B:" indicates a data flow from entity A to entity B, while "A:" indicates an operation performed locally by A. In the protocol
SimpleTagAuth, presented in FIG. 3, a trusted reader R attempts to authenticate a tag T.
<BR><BR>A tag that does not carry a valid identifier T.sub.x for some x (or at least one known to the reader) will not achieve successful authentication in this protocol.  Thus an adversary cannot successfully clone a tag without knowledge of a valid
T.sub.x obtained, for example, via skimming.
<BR><BR>On the other hand, consider a clone i that is EPC-compliant but created via a simple skimming attack.  Such an EPC-compliant clone i might be easily created, for instance, through configuration of a field-programmable EPC tag.  Obviously,
skimming reveals the EPC of a tag, but not the secret K.sub.i.  For i to cause a "valid" output, therefore, its creator would need to guess K.sub.i correctly.  For an l-bit PIN, the probability of successful cloning is therefore just 2.sup.-l. As a kill
PIN in Class-1 Generation-2 tags is 32-bits long, the probability of successful cloning of a single, given EPC tag is therefore less than one-in-a-billion.
<BR><BR>When performing active attacks against a tag i, an adversary can of course actively test multiple possible values of K.sub.i.  With 32-bit PINs, though, this form of active attack is largely impractical.  Some EPC tags currently defend against
PIN-guessing by temporarily disabling a tag when multiple incorrect PINs are presented.  See, e.g., "RFID, privacy, and corporate data," RFID Journal, 2 Jun.  2003.  However, these tags generally have short PINs, e.g., 8 bits in length.  It is unclear
whether manufacturers of tags with 32-bit PINs will adopt this approach, or whether it is even necessary.
<BR><BR>3.1 Non-Compliant Clones
<BR><BR>The SimpleTagAuth protocol of FIG. 3 has a basic vulnerability: If the cloned tag i is not EPC-compliant, then it can spoof the reader.  It suffices for i simply to accept any PIN, in which case the protocol will always output "valid."
<BR><BR>To detect non-compliant clones of this kind, we propose the introduction of spurious PINs into the FIG. 3 protocol.  In this approach, the reader tests the response of a tag to some randomly presented PINs that are not valid.  If the PIN-test
operation yields a `1` in response to any of these PINs, then the reader can identify it as counterfeit.  We include these ideas in a protocol that we call BasicTagAuth, shown in FIG. 4.
<BR><BR>Here the value q is a security parameter that specifies the number of spurious PINs to be generated.  The function GeneratePINSet generates a set of q-1 spurious PINs uniformly at random (without duplication).  Among these is randomly inserted
the one correct kill PIN K.sub.i in a random position j, which is also output by the function GeneratePINSet.  We detail the exact operation of GeneratePINSet at the end of this section.
<BR><BR>For an attacker that performs skimming attacks only, the best strategy to defeat the protocol BasicTagAuth is to create a clone device that attempts to guess the correct PIN-trial j uniformly at random (or contains a pre-programmed guess).  Note
that the main protocol loop is not halted on determination of tag validity.  While continuation is not strictly necessary, our aim is to emphasize the value of concealing timing information that can shed light on the validity of a given tag or a given
PIN.  The probability of successful attack in this case, i.e., of the cloned tag appearing to be valid, is clearly just 1/q.
<BR><BR>BasicTagAuth is naturally time-consuming for large values of q. To prevent more than casual introduction of counterfeit tags into an RFID system, however, it would suffice to detect such tags with significant but not overwhelming probability. 
For this purpose, even q=2, i.e., a single spurious PIN, would generally be adequate.  Moreover, it is possible to implement this protocol, or any of the other protocols of the illustrative embodiments, on a periodic or probabilistic basis, i.e., to test
the authenticity of just a fraction of tags.
<BR><BR>An adversary that performs eavesdropping on the authentication protocol itself, of course, can defeat it completely, as can an adversary that performs the following three-step attack: (1) The adversary skims a tag or otherwise obtains T.sub.i;
(2) The adversary interacts with a valid reader and obtains the PIN set {P.sub.i.sup.(j)}.sub.j=1.sup.q; (3) The adversary actively tests values in the PIN set {P.sub.i.sup.(j)}.sub.j=1.sup.q on tag i.
<BR><BR>There are at least two ways that the function GeneratePINSet can generate spurious PINs.  One method is random selection.  In particular, the set {P.sub.i.sup.(n)}.sub.n=1.sup.q may be selected uniformly at random without duplication from {0,
1}.sup.k.  The true PIN K.sub.i should then replace a random element P.sub.i.sup.(j) for j.epsilon..sub.U {1, 2, .  . . , q}.
<BR><BR>In this example, the PIN set {P.sub.i.sup.(n)} must remain static over all invocations of BasicTagAuth.  This is important in that if the set of spurious PINs were to change from session to session, then an adversary could determine P.sub.i by
computing the intersection between or among PIN sets.  Thus, if already invoked for tag i, the function GeneratePINSet should simply output the existing set {P.sub.i.sup.(n)}.sub.n=1.sup.q.
<BR><BR>As a second approach to spurious-PIN generation, it is possible to avoid the need for storing the set {P.sub.i.sup.(n)}.sub.n=1.sup.q by generating it pseudorandomly.  To use informal notation here, let f denote a one-way hash function, and x
denote a master secret-key held by the reader R. For a positive integer z and non-empty set S={q.sub.0,q.sub.1, .  . . , q.sub.|S|-1}, let S.sub.[z] denote the element q.sub.z mod|S|.  GeneratePINSet may be constructed as follows: GeneratePINSet(i)[q]
Q.rarw.K.sub.i; for n=1 to q do P.sub.i.sup.(n).rarw.{{0,1}.sup.k-Q}.sub.[f(x,i,n)]; Q.rarw.Q.orgate.{P.sub.i.sup.(n)}; j.rarw.{1,2, .  . . , q}.sub.[f(x,i,q+1)]; P.sub.i.sup.(j).rarw.K.sub.i; output (j,{P.sub.i.sup.(n)}.sub.n=1.sup.q);
<BR><BR>Of course, there are many alternative approaches to generating PIN sets, e.g., selecting P.sub.i.sup.(n) uniformly from {0, 1}.sup.k and rejecting it if it is in Q, or even retaining duplicates at the cost of a small degradation in security.
<BR><BR>4.  Authenticating Enhanced EPC Tags
<BR><BR>As we have explained, enhanced EPC tags permit configuration such that a reader must transmit the access PIN to a tag in order to read its resident kill PIN.  This opens up the possibility of using the kill PIN for an unintended purpose, as a
secret permitting tag authentication.  In another illustrative embodiment, tags are authenticated using a fixed-value mutual-authentication protocol, in which the access PIN serves to authenticate the reader, and the kill PIN in turn serves to
authenticate the tag.
<BR><BR>FIG. 5 shows an example of such a protocol, also referred to herein as EnhancedTagAuth.  Let A.sub.i denote the access PIN for tag i. An adversary that has skimmed tag i and attempts to simulate it in the EnhancedTagAuth protocol can create a
counterfeit device that implicitly accepts the access PIN and then guesses the kill PIN.  This will succeed with probability 2.sup.-l, where l is the bit-length of the kill PIN, just as in the SimpleTagAuth protocol of FIG. 3.  Thus, an enhanced EPC tag
will resist a single invocation of this attack with probability more than one-in-a-billion.  This is significantly better than the security achievable through BasicTagAuth with any practical value of q. On the other hand, the EnhancedTagAuth protocol is
still vulnerable to eavesdropping and to the three-step active attack outlined above for BasicTagAuth.
<BR><BR>As we noted above, EPC tags support partial reads and writes.  PINs are two words long; read and write operations may address just a single word.  Thus, it is possible to combat passive eavesdropping attacks to a very limited extent by treating
the 32-bit kill PIN as two 16-bit secrets K.sub.i,1 and K.sub.i,2.  For example, readers within one security zone might verify the correctness of K.sub.i,1, while those in a second security zone check K.sub.i,2.  In the language of the FIG. 5 protocol,
K.rarw.K.sub.i,z in security zone z.epsilon.1,2.  Passive eavesdropping within one perimeter, then, would not permit tag cloning in the other.
<BR><BR>Finally, we observe that the BasicTagAuth protocol can be used for enhanced EPC tags in the case where the reader has access to only an access PIN or kill PIN for a given tag, or where the tag itself has only one programmed PIN.
<BR><BR>5.  Untrusted Readers
<BR><BR>A working assumption in the description of the illustrative protocols thus far has been that readers are trustworthy verifiers.  More specifically, we have assumed that the reader R may be entrusted a priori with the PINs for a given tag.  This
assumption may not always be architecturally desirable, though.
<BR><BR>We may wish instead to consider that a trusted verifier entity V with knowledge of P.sub.i is not identical with the reader R participating in the protocol.  The verifier V might instead be a secure, centralized server that interacts with one or
more readers.  For example, V may be a given one of the servers 108, 110 in the system 100 of FIG. 1, or other type of trusted system entity.  We may then view the authenticating entity in our protocol as a combination of R and an allegedly valid EPC
tag: The reader R tries to prove to V that it is scanning a particular tag i. This view yields a new protocol variant with entities V, R, and presumed tag T.
<BR><BR>FIG. 6 shows a modification of the protocol BasicTagAuth of FIG. 4 to achieve this scenario with untrusted readers.  The modified protocol is referred to as BasicTagAuth.sup.+.
<BR><BR>In this modified protocol, the reader may be viewed simply as an untrusted communications medium by which the tag communicates with V. Without access to tag i, the reader R itself does not learn which of the presented PINs is the correct one. 
Hence the security properties of this protocol with respect to an attacker that has compromised R and knows T.sub.i alone are similar to those for BasicTagAuth with respect to an attacker that only knows T.sub.i.  In brief, with knowledge of T.sub.i
alone, the best an attacker can do in creating a clone is to guess the correct PIN uniformly at random from a set of q PINs.  Thus, the attacker can only successfully clone a tag with probability 1/q. On the other hand, once it scans tag i, of course,
the reader R (and attacker that has compromised the reader) does learn K.sub.i.
<BR><BR>The protocol variant BasicTagAuth.sup.+ is particularly interesting because readers represent a salient point of compromise in RFID systems.  In a naive deployment, a reader might be capable of accessing a PIN K.sub.i (from a database, for
instance) for any tag identifier T.sub.i.  In such a system, compromise of a single reader would result in massive compromise of tag PINs.  An attacker with access to the compromised reader would be able to learn the PIN K.sub.i associated with any tag
identifier T.sub.i and then clone the tag perfectly.
<BR><BR>This situation is particularly problematic because RFID readers will inevitably become ubiquitous peripherals.  They will populate warehouses, storage rooms, trucks, and retail environments.  In many RFID architectures readers may be given
unfettered access to backend systems in order to query for PINs.  Use of the protocol BasicTagAuth.sup.+ can help address the problems associated with reader compromise, by limiting access on the part of misbehaving readers.
<BR><BR>In some architectures where network failures are a concern, readers or associated devices might store large numbers of tag PINs locally.  The protocol BasicTagAuth.sup.+ can offer stronger security even in this environment.  Rather than storing
PINs locally, readers can instead store the kill PIN sets generated by GeneratePINSet.  Compromise of the reader would no longer then lead to direct compromise of true tag PINs and the ability to clone skimmed tags.
<BR><BR>A drawback to the BasicTagAuth.sup.+ approach is that to execute sensitive tag operations, a reader would have to try multiple PINs, i.e., cycle through the stored PIN set for a tag.  However, with q=2, i.e., a single spurious PIN per tag, we
believe an RFID system could offer reasonably strong defense against general tag cloning, with minimal impact on performance.
<BR><BR>In systems where tag identifiers are sparse and hard to predict, we note that a reader might effectively demonstrate radio contact with a tag merely by submitting its identifier T.sub.i.
<BR><BR>Achieving authentication of enhanced EPC tags with untrusted readers is a simpler exercise than for basic EPC tags.  For enhanced EPC tags, it is not necessary to store kill PINs on readers, but instead sufficient to have a reader transmit a kill
PIN to V for verification.  Of course, if kill PINs are also being used for killing, then readers may need more general access to these PINs.  In that case, it is possible to take more or less the same approach as with BasicTagAuth.sup.+: Readers do not
store correct kill PINs alone, but rather the sets generated by GeneratePINSet.
<BR><BR>Spurious PINs themselves might be used to trace the origin of counterfeiting attempts.  For example, suppose i that a counterfeit tag is encountered in the field with an invalid PIN {umlaut over (K)}.sub.i that corresponds to one of the spurious
PINs for tag i. In this case, we might flag i as likely to have been fabricated using information from a compromised reader.  It is even possible to customize spurious PINs not just for particular tags, but for particular readers or sets of readers.  A
counterfeit tag emitting a spurious PIN would then provide information on which reader or set of readers leaked the data used in its fabrication.  This latter approach, however, would need careful deployment, as intersection among spurious PIN sets leaks
information about which PIN is the valid one.  Thus, some degree of overlap among sets would be desirable.
<BR><BR>While spurious PINs help prevent cloning in the illustrative protocols described above, they do not defend against certain attacks made directly on legitimate tags.  For example, if an attacker wishes to kill a tag, and has a small set of
candidate kill PINs for the tag, the attacker can simply try all of the PINs exhaustively.  Executing BasicTagAuth.sup.+ on untrusted readers can indeed exacerbate such problems.  Of course, this is not an issue when the kill operation is hobbled as we
propose above.
<BR><BR>5.1 Preventing en bloc PIN Theft: Fulfillment-Conditional PIN Distribution (FCPD)
<BR><BR>We have considered techniques by which untrusted readers may be used to authenticate tags.  The techniques we have introduced here, though, may serve a different and somewhat unrelated security goal, namely the prevention of en bloc theft of PINs
by compromised readers.  We propose an approach that we call fulfillment-conditional PIN distribution, and abbreviate FCPD.
<BR><BR>We observe that the BasicTagAuth.sup.+ protocol of FIG. 6 does not merely verify the authenticity of a tag T; it verifies that a reader R actually has physical access to T. The idea behind fulfillment-conditional PIN distribution is thus as
follows.  We ensure that a reader may only download PINs for a particular set of tags if it is entitled to do so by merit of its physically accessing the tags.  Viewed another way, we furnish PINs to a reader only if it can prove that it is using them
successfully.
<BR><BR>Let us assume that a reader R (being a computationally high-powered device) is capable of strong authentication to a central authority V. The idea is for V to honor PIN requests by R. V executes BasicTagAuth.sup.+ with R periodically.  If R
provides valid answers, then V continues to satisfy PIN requests.  If not, then V concludes that R is not successfully making use of the PINs it receives.  This implies that either (1) R is scanning forged tags or (2) R is not scanning the tags for which
it is requesting PINs.
<BR><BR>An important observation is that FCPD works even when PIN-test is just a one-time operation, e.g., a conventionally executed kill operation.  Since the aim is to ensure proper behavior by R, and not the authenticity of tags themselves, multiple
successful tests of PIN validity for a given tag, e.g., multiple tag kills, are unnecessary.  Also, FCPD, like the illustrative authentication protocols, may be effective even when executed for just a fraction of tags, e.g., probabilistically.
<BR><BR>There are other possible approaches to preventing en bloc theft of PINs by compromised readers.  For example, V may simply meter the rate at which R receives PINs.  If this rate exceeds a certain threshold, V may either refuse to transmit further
PINs for some period of time or may flag R as compromised.  For example, if R is a reader at a retail point of sale, then V might limit the number of PIN requests by R to, say, 10,000 per hour.
<BR><BR>FCPD, though, has a couple of advantages over metering:
<BR><BR>1.  Detection efficiency: FCPD can efficiently detect reader compromise after just a small number of requests.  When based, for example, on BasicTagAuth.sup.+ with q=2, FCPD can detect rogue downloading of mere tens of PINs with overwhelming
probability.  Metering does not permit this level of sensitivity.  In fact, an attacker can easily evade detection in the metering approach by downloading PINs at a fractionally lower rate than the detection threshold.  FCPD, on the other hand, detects
attacks probabilistically, and thus renders evasion of detection more difficult.
<BR><BR>2.  Calibration: Metering requires careful calibration of the detection threshold.  If set too low, false positives will result; set too high, and false negatives will result.  FCPD requires less delicate calibration.  False positives, for
example, should not occur in a system where tags function properly, while the false negative rate may be set quite low with little sacrifice of efficiency.
<BR><BR>Of course, an attacker that uses a compromised reader to access tags directly, e.g., to kill them, can defeat the FCPD approach.  FCPD, however, at least constrains an attacker to using PINs immediately in order to exploit them.  It may therefore
be desirable to strengthen FCPD with complementary countermeasures, including metering and detection of kill-command or access-command emissions in inappropriate physical locations, e.g., near store shelves.
<BR><BR>6.  Stronger Attacks
<BR><BR>Skimming is perhaps the easiest and most practical cloning attack and therefore the most important to defend against.  Stronger attacks, however, would defeat the illustrative protocols described above, as in the following examples.
<BR><BR>1.  Database breaches: An adversary capable of breaching a database containing the PINs of tags will of course be able to clone a tag perfectly.  In a naively architected system, compromise of a valid reader could potentially have the effect of
giving an adversary access to this database.
<BR><BR>2.  Reverse engineering: EPC tags are simple devices that provide no real tamper resistance.  A moderately sophisticated adversary can therefore reverse-engineer a captured tag and extract its PIN.  Such an adversary can of course clone the tag
perfectly.
<BR><BR>3.  Active attacks: As we have noted, an adversary can extract the PINs from a target EPC tag i and clone it on performing the following three steps: (1) Obtain T.sub.i; (2) Interact with a valid reader that executes one of the above-described
authentication protocols; and (3) Interact with the tag i. Without more functionality in EPC tags, we believe it is not possible to defend effectively against such attacks.  Thankfully, such attacks require more sophistication than skimming alone.
<BR><BR>Man-in-the-middle attacks (in which the attacker creates a real-time "wormhole" between the target EPC tag and reader) are a general security problem for RFID systems.
<BR><BR>A very important point to note here is that not all readers in an RFID system need be entrusted with tag-authentication capabilities.  The authentication protocols we propose may be executed on just a small set of highly secured readers.  By
restricting counterfeit-tag detection to within a narrow perimeter, we can help mitigate system vulnerability to active attacks, and in particular the three-step attack described above.
<BR><BR>4.  Eavesdropping: As we have noted already, an adversary capable of full eavesdropping on the communications between the reader and tag can easily harvest the correct PINs for a tag.  There are some important technical qualifications to
consider, though.
<BR><BR>The signal strength of the reader-to-tag channel is usually considerably stronger than that of the tag-to-reader channel.  In the illustrative embodiments, the reader is an active device, while RFID tags are passive devices that receive their
transmission power from the reader.  An adversary can therefore more easily eavesdrop on the reader-to-tag channel.  Such eavesdropping may take place at a distance of hundreds of meters, while eavesdropping on tag emissions is feasible at the very most
from some tens of meters away (using off-the-shelf readers, at least).
<BR><BR>Recognizing this asymmetry in signal strength, the EPCglobal standard prescribes protocols in which tags transmit random pads (bit-strings) to readers.  Readers use these pads effectively to encrypt sensitive data, namely PINs, when communicating
with tags.  Assuming good random-number generation on the tags, this approach renders eavesdropping feasible only on the tag-to-reader channel.
<BR><BR>Thus, to mount a successful cloning attack against the protocols described above, an adversary would need to eavesdrop on the weaker tag-to-reader channel.
<BR><BR>To a limited extent, periodic re-writing of EPC tag PINs can help defend against these attacks.  An adversary capable of eavesdropping on only a periodic basis may not be able to learn the most up-to-date PIN employed by a given system. 
Likewise, an adversary that reverse-engineers a tag will be unable to seed a system with clones that remain up-to-date.  There is a limitation on the regularity with which PIN changes can be viably performed, though.  In general, writing to RFID tags is
a more difficult operation than reading; it is less reliable, and requires greater reader proximity.  Additionally, writeable memory, e.g., EEPROM, has a limited lifetime.  Nonetheless, updates performed with only modest frequency could offer
considerably strengthened security.  See, e.g., A. Juels, "Minimalist <B><I>cryptography</I></B> for low-cost RFID tags," C. Blundo and S. Cimato, editors, Security in Communication Networks (SCN 04), pp.  149-164, Springer-Verlag, 2004, LNCS No. 3352.
<BR><BR>The present invention in the illustrative embodiments described above provides simple, practical authentication techniques that combat skimming attacks against EPC tags that are compliant with the EPC Class-1 Generation-2 UHF-RFID standard of
EPCglobal, as well as other types of RFID tags or devices.  The protocols of the illustrative embodiments may be viewed as involving a kind of role-reversal for the PINs in EPC tags.  While these PINs are meant by design to serve for reader-to-tag
authentication, we show how they may in fact provide tag-to-reader authentication and thereby help prevent skimming attacks.  As we anticipate that many industry uses of EPC tags will come to rely either implicitly or explicitly on their resistance to
counterfeiting, the exemplary protocols can provide particularly valuable improvements in real-world systems.
<BR><BR>The authentication protocols of the illustrative embodiments do not defend against attacks that are substantially more sophisticated than skimming.  However, significant improvements are provided within the constraints imposed by the EPCglobal
Class-1 Generation-2 standard which, again, contains no explicit anti-cloning features at all.  Moreover, as we have explained, by creating a more highly secure perimeter for the set of readers executing authentication protocols, through the use of a
separate verifier or similar techniques, it is possible to limit vulnerability to more sophisticated attacks.
<BR><BR>Another advantage of the authentication protocols of the illustrative embodiments is that such protocols can also be used to provide secure distribution of PINs in RFID systems, via the FCPD technique previously described, thereby addressing the
problem of en bloc theft of PINs by compromised readers.
<BR><BR>It is to be appreciated that the particular configuration, elements and operating parameters of the illustrative embodiments are not requirements of the invention, and should not be construed as limiting the scope of the invention in any way.
<BR><BR>For example, the system elements and their configuration as shown in FIGS. 1 and 2 may be varied in alternative embodiments.  Similarly, the particular protocol steps in the diagrams of FIGS. 3, 4, 5 and 6 can be varied in alternative
embodiments.  As one more particular example, certain operations described as being performed by a reader in one embodiment can be performed at least in part by a verifier in an alternative embodiment, or may be performed jointly by cooperating reader
and verifier elements in still further alternative embodiments.  Those skilled in the art can make these and other modifications in the described embodiments in a straightforward manner.
<BR><BR>In addition, although described in the context of EPC tags and associated kill and access PINs, the techniques of the present invention may be implemented in systems which utilize a wide variety of other types of RFID devices and associated
control codes.  Such control codes may be associated with tag functions other than kill and access.
<BR><BR>Furthermore, the various simplifying assumptions made above in the course of describing the illustrative embodiments should also be viewed as exemplary rather than as requirements or limitations of the invention.  In alternative embodiments, one
or more of these assumptions need not apply.
<BR><BR>These and numerous other alternative embodiments within the scope of the appended claims will be readily apparent to those skilled in the art.
<BR><BR><CENTER><B>* * * * *</B></CENTER>
<HR>
<CENTER>
<a href=http://patimg2.uspto.gov/.piw?Docid=07750793&homeurl=http%3A%2F%2Fpatft.uspto.gov%2Fnetacgi%2Fnph-Parser%3FSect1%3DPTO2%2526Sect2%3DHITOFF%2526u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%2526r%3D17%2526p%3D1%2526f%3DG%2526l%3D50%2526d%3DPTXT%2526S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).ABTX.%252BAND%252B(((Cryptography%252BOR%252BCrypto)%252BOR%252BEncryption)%252BOR%252BCipher))%2526OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(Cryptography%252Bor%252BCrypto%252Bor%252BEncryption%252Bor%252BCipher)%2526RS%3D(ABST%2F(RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522)%252BAND%252B(((Cryptography%252BOR%252BCrypto)%252BOR%252BEncryption)%252BOR%252BCipher))&PageNum=&Rtype=&SectionNum=&idkey=NONE&Input=View+first+page><img src="/netaicon/PTO/image.gif" alt="[Image]" border="0" valign="middle"></A>
<table>
<tr><td align=center><A HREF="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/ShowShoppingCart?backUrl1=http%3A//patft1.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D17%26p%3D1%26f%3DG%26l%3D50%26d%3DPTXT%26S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).ABTX.%252BAND%252B(((Cryptography%252BOR%252BCrypto)%252BOR%252BEncryption)%252BOR%252BCipher))%26OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(Cryptography%252Bor%252BCrypto%252Bor%252BEncryption%252Bor%252BCipher)&backLabel1=Back%20to%20Document%3A%207750793"><img border=0 src="/netaicon/PTO/cart.gif" border=
0 valign=middle alt="[View Shopping Cart]"></A>
<A HREF="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/AddToShoppingCart?docNumber=7750793&backUrl1=http%3A//patft1.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D17%26p%3D1%26f%3DG%26l%3D50%26d%3DPTXT%26S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).ABTX.%252BAND%252B(((Cryptography%252BOR%252BCrypto)%252BOR%252BEncryption)%252BOR%252BCipher))%26OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(Cryptography%252Bor%252BCrypto%252Bor%252BEncryption%252Bor%252BCipher)&backLabel1=Back%20to%20Document%3A%207750793">
<img border=0 src="/netaicon/PTO/order.gif" valign=middle alt="[Add to Shopping Cart]"></A>
</td></tr>
<tr><td align=center>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=17&p=1&f=S&l=50&d=PTXT&S1=((RFID+OR+%22radio+frequency+identification%22).ABTX.+AND+(((Cryptography+OR+Crypto)+OR+Encryption)+OR+Cipher))&Query=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(Cryptography+or+Crypto+or+Encryption+or+Cipher)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/hitlist.gif border=0 ALT=[HIT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=17&p=2&f=S&l=50&d=PTXT&S1=((RFID+OR+%22radio+frequency+identification%22).ABTX.+AND+(((Cryptography+OR+Crypto)+OR+Encryption)+OR+Cipher))&Query=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(Cryptography+or+Crypto+or+Encryption+or+Cipher)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextlist.gif border=0 ALT=[NEXT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=16&p=1&f=G&l=50&d=PTXT&S1=((RFID+OR+%22radio+frequency+identification%22).ABTX.+AND+(((Cryptography+OR+Crypto)+OR+Encryption)+OR+Cipher))&OS=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(Cryptography+or+Crypto+or+Encryption+or+Cipher)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/prevdoc.gif border=0 ALT=[PREV_DOC]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=18&p=1&f=G&l=50&d=PTXT&S1=((RFID+OR+%22radio+frequency+identification%22).ABTX.+AND+(((Cryptography+OR+Crypto)+OR+Encryption)+OR+Cipher))&OS=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(Cryptography+or+Crypto+or+Encryption+or+Cipher)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextdoc.gif border=0 ALT=[NEXT_DOC]></A>

<a href="#top"><img valign=middle src="/netaicon/PTO/top.gif" border=0 alt="[Top]"></a>
</td></tr>
</table>
<a name="bottom"></a>
<a href="http://www.uspto.gov/patft/index.html"><img src="/netaicon/PTO/home.gif" alt="[Home]" border="0" valign=middle></a>
<a href="/netahtml/PTO/search-bool.html"><img src="/netaicon/PTO/boolean.gif" alt="[Boolean Search]" border="0" valign=middle></a>
<A HREF="/netahtml/PTO/search-adv.htm"><IMG BORDER="0" SRC="/netaicon/PTO/manual.gif" ALT="[Manual Search]" valign=middle></A>
<a href="/netahtml/PTO/srchnum.htm"><img src="/netaicon/PTO/number.gif" alt="[Number Search]" border="0" valign=middle></a>
<A HREF="http://www.uspto.gov/patft/help/help.htm"><IMG BORDER="0" SRC="/netaicon/PTO/help.gif" ALT="[Help]" valign=middle></A>
</center>
</BODY>
</HTML>